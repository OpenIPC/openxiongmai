#include "xm_i2c.h"
#include "xm_print.h"
#include "xm_sns_ctrl.h"
#include "xm_type.h"
extern void SysDelay_ms(XM_S32 ms);

static const XM_U16 gau16SnsInit_sc335e[][2] = {
    // ExtClk: 24M MCLK 158.4M
    {0x0103, 0x01}, {0x0100, 0x00}, {0x3039, 0x80}, {0x3034, 0x80},
    {0x3030, 0x01}, {0x3035, 0x82},

    {0x3036, 0x40}, {0x3038, 0x44}, {0x303a, 0x75}, {0x303b, 0x0e},

    {0x303c, 0x09}, {0x3200, 0x00}, {0x3201, 0x00}, {0x3202, 0x00},
    {0x3203, 0x00},

    {0x3204, 0x0a}, {0x3205, 0x27}, {0x3206, 0x07}, {0x3207, 0x9f},
    {0x3208, 0x0a},

    {0x3209, 0x28}, {0x320a, 0x07}, {0x320b, 0xa0}, {0x320c, 0x07},
    {0x320d, 0xd0},

    {0x320e, 0x07}, {0x320f, 0xbc}, {0x3210, 0x00}, {0x3211, 0x00},
    {0x3212, 0x00},

    {0x3213, 0x00}, {0x3235, 0x0f}, {0x3236, 0x76}, {0x3237, 0x03},
    {0x3238, 0x89},

    {0x3300, 0x10}, {0x3301, 0x14}, {0x3306, 0xa0}, {0x3308, 0x10},
    {0x3309, 0x30},

    {0x330a, 0x01}, {0x330b, 0xe0}, {0x331f, 0x27}, {0x3321, 0x2a},
    {0x3333, 0x90},

    {0x3334, 0xc0}, {0x3338, 0x50}, {0x335d, 0x80}, {0x3364, 0x05},
    {0x3400, 0x53},

    {0x3416, 0x11}, {0x3620, 0x43}, {0x3621, 0x08}, {0x3622, 0x10},
    {0x3627, 0x04},

    {0x3630, 0x07}, {0x3631, 0x80}, {0x3632, 0x00}, {0x3633, 0xf4},
    {0x3635, 0x92},

    {0x3637, 0x80}, {0x3638, 0x82}, {0x3639, 0x05}, {0x363a, 0x07},
    {0x3802, 0x01},

    {0x3e01, 0x00}, // 0xF3
    {0x3e02, 0xa0}, {0x3e03, 0x0b}, {0x3e08, 0x00}, {0x3f00, 0xc3},

    {0x3f02, 0x02}, {0x3f08, 0x02}, {0x4500, 0x31}, {0x4837, 0x19}, // 0x16
    {0x3652, 0x22}, // lane ÑÓÊ±£¬ 100ps/step£¬Ä¬ÈÏ 3¡¯b100
    {0x3654, 0x04}, {0x3034, 0x07}, {0x3039, 0x41}, {0x0100, 0x01}};

void sensor_init_sc335e(void) {
  XM_U16 u16Num, u16i;
  u16Num = sizeof(gau16SnsInit_sc335e) / sizeof(gau16SnsInit_sc335e[0]);
  sensor_write_register(
      (XM_U32)gau16SnsInit_sc335e[0][0],
      (XM_U32)gau16SnsInit_sc335e[0][1]); // reset all registers
  SysDelay_ms(50);
  for (u16i = 1; u16i < u16Num; u16i++) {
    sensor_write_register((XM_U32)gau16SnsInit_sc335e[u16i][0],
                          (XM_U32)gau16SnsInit_sc335e[u16i][1]);
  }
  SysDelay_ms(20);
  DEBUG("------------- SC5300 5M 15fps  init ok! "
        "(@201801225_158x4)----------------\n");
}
